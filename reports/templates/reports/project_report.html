{% extends "base.html" %}
{% block title %}Project Report{% endblock %}
{% block content %}
    <h1>Report</h1>
    <p>Sum: {{ result.sum }}</p>
    <p>Average: {{ result.avg }}</p>
    <h2>User Reports</h2>
    <table>
        <thead>
        <tr>
            <th>User</th>
            <th>Paid</th>
            <th>Result</th>
        </tr>
        </thead>
        <tbody>
        {% for user, user_report in result.user_reports.items %}
            <tr>
                <td>{{ user }}</td>
                <td>{{ user_report.paid }}</td>
                {% if user_report.result.should_get %}
                    <td>{{ user }} should get {{ user_report.result.value }} from other users</td>
                {% else %}
                    <td>{{ user }} should pay {{ user_report.result.value }} to other users</td>
                {% endif %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% if not confirmed %}
        <h1>Details</h1>
    {% else %}
        <h1>Calculated Costs</h1>
    {% endif %}
    <table>
        <tr>
            <th class="w3-xlarge">Date</th>
            <th class="w3-xlarge">Name</th>
            <th class="w3-xlarge">Cost</th>
            <th class="w3-xlarge">Comment</th>
            <th class="w3-xlarge">Payer</th>
        </tr>
        {% for cost in costs %}
            <tr>
                <td class="w3-large">{{ cost.created_at }}</td>
                <td class="w3-large">{{ cost.name }}</td>
                <td class="w3-large">{{ cost.cost }}</td>
                <td class="w3-large">{{ cost.comment }}</td>
                <td class="w3-large">{{ cost.payer }}</td>
            </tr>
        {% endfor %}
    </table>
    {% if not confirmed %}
        <form action="" method="post">
            {% csrf_token %}
            {% for cost in costs %}
                <input type="hidden" name="cost_ids" value="{{ cost.id }}">
            {% endfor %}

            <input class="w3-button w3-xlarge" type="submit" value="Confirm">
            <a class="w3-button w3-xlarge" href="{% url 'sheets:cost-list' %}">No</a>
        </form>
    {% else %}
        <a class="w3-button" href="{% url 'sheets:add-costs' %}">Back</a>
    {% endif %}
{% endblock %}